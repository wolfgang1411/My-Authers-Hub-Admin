<div class="flex flex-col flex-grow gap-4">
  <nav class="flex flex-col gap-6 sticky z-10 py-4">
    <div class="flex justify-between items-center">
      <h3 class="heading">{{ "authorDetails" | translate }}</h3>
      <app-back></app-back>
    </div>
  </nav>
  <mat-tab-group dynamicHeight>
    <mat-tab>
      <ng-template mat-tab-label>
        <span class="text-text-heading font-medium">
          {{ "authorDetails" | translate }}
        </span>
      </ng-template>

      <!-- MAIN CARD -->
      <section class="mt-8 bg-white p-8 rounded-xl shadow-md mat-elevation-z4">
        <!-- ================= HEADER ================= -->
        <div class="flex items-center gap-6 pb-6 border-b">
          <!-- Profile Image -->
          <div
            class="w-28 h-28 rounded-full overflow-hidden shadow border flex items-center justify-center"
          >
            @if (authorDetails() && authorDetails()?.medias &&
            authorDetails()?.medias?.length) {
            <img
              [src]="(authorDetails()?.medias?.[0]?.url ?? 'images/user-solid-full.svg') | safeUrl"
              class="w-full h-full object-cover"
            />
            } @if (!authorDetails()?.medias?.length) {
            <img
              src="images/user-solid-full.svg"
              class="w-16 h-16 opacity-60"
            />
            }
          </div>

          <!-- Title -->
          <div>
            <h2 class="text-2xl font-medium text-text-heading capitalize">
              {{ authorDetails()?.user?.firstName }}
              {{ authorDetails()?.user?.lastName }}
            </h2>

            <p class="text-gray-500 text-sm mt-1">
              {{ authorDetails()?.username || "No Username" }}
            </p>

            <p class="text-gray-600 text-sm mt-1">
              {{ authorDetails()?.email }}
            </p>
          </div>
        </div>

        <!-- ================= AUTHOR DETAILS ================= -->
        <div class="mt-8">
          <h3 class="text-lg font-semibold text-gray-800 mb-4">
            {{ "authorDetails" | translate }}
          </h3>

          <div class="grid grid-cols-2 lg:grid-cols-3 gap-6 text-sm">
            <div>
              <span class="font-medium">Username:</span>
              {{ authorDetails()?.username }}
            </div>
            <div>
              <span class="font-medium">Official Email:</span>
              {{ authorDetails()?.email }}
            </div>
            <div>
              <span class="font-medium">Author Name:</span>
              {{ authorDetails()?.user?.firstName }}
              {{ authorDetails()?.user?.lastName }}
            </div>

            <div>
              <span class="font-medium">Contact Number:</span>
              {{ authorDetails()?.user?.phoneNumber }}
            </div>
            <div>
              <span class="font-medium">Email ID:</span>
              {{ authorDetails()?.user?.email }}
            </div>

            <div class="col-span-2">
              <span class="font-medium">Address:</span> {{ completeAddress() }}
            </div>
          </div>
        </div>

        <!-- ================= BANK DETAILS ================= -->
        <div class="mt-10">
          <h3 class="text-lg font-semibold text-gray-800 mb-4">
            {{ "bankdetails" | translate }}
          </h3>

          <div class="grid grid-cols-2 lg:grid-cols-3 gap-6 text-sm">
            <div>
              <span class="font-medium">Bank Name:</span>
              {{ authorDetails()?.bankDetails?.[0]?.name || "Not Provided" }}
            </div>
            <div>
              <span class="font-medium">Account Number:</span>
              {{ authorDetails()?.bankDetails?.[0]?.accountNo }}
            </div>
            <div>
              <span class="font-medium">IFSC Code:</span>
              {{ authorDetails()?.bankDetails?.[0]?.ifsc }}
            </div>
            <div>
              <span class="font-medium">Account Type:</span>
              {{ authorDetails()?.bankDetails?.[0]?.accountType }}
            </div>
            <div>
              <span class="font-medium">PAN Number:</span>
              {{ authorDetails()?.bankDetails?.[0]?.panCardNo }}
            </div>
          </div>
        </div>
      </section>
    </mat-tab>

    <!-- Books Published -->
    <mat-tab>
      <ng-template mat-tab-label>
        <span class="text-text-heading font-medium">
          {{ "bookspublished" | translate }}
        </span>
      </ng-template>
      <section
        id="books-published"
        class="mt-10 bg-white p-6 rounded-xl shadow"
      >
        <div class="flex justify-between">
          <h2 class="heading mb-4">{{ "bookspublished" | translate }}</h2>
          <mat-form-field>
            <mat-label>{{ "filter" | translate }}</mat-label>
            <input
              matInput
              (keyup)="applyFilter($event)"
              placeholder="Ex. ium"
              #input
            />
          </mat-form-field>
        </div>
        <app-list-table
          class="pt-6"
          [dataSource]="bookPublishData"
          [displayedColumns]="displayedColumns"
        >
        </app-list-table>
      </section>
    </mat-tab>
    <!-- Authors -->
    <!-- <mat-tab>
      <ng-template mat-tab-label>
        <span class="text-text-heading font-medium">
          {{ "authors" | translate }}
        </span>
      </ng-template>
      <section id="authors" class="mt-10 bg-white p-6 rounded-xl shadow">
        <div class="flex justify-between">
          <h2 class="heading mb-4">{{ "authors" | translate }}</h2>
          <mat-form-field>
            <mat-label>{{ "filter" | translate }}</mat-label>
            <input
              matInput
              (input)="applyAuthorFilter($event)"
              placeholder="Ex. ium"
              #input
            />
          </mat-form-field>
        </div>
        <app-list-table
          class="pt-6"
          [dataSource]="authorData"
          [displayedColumns]="displayedAuthorColumns"
        >
        </app-list-table>
      </section>
    </mat-tab> -->
    <!-- Sub-Publishers -->
    <mat-tab>
      <ng-template mat-tab-label>
        <span class="text-text-heading font-medium">
          {{ "publishers" | translate }}
        </span>
      </ng-template>
      <section id="sub-publishers" class="mt-10 bg-white p-6 rounded-xl shadow">
        <div class="flex justify-between">
          <h2 class="heading mb-4">{{ "publishers" | translate }}</h2>
          <mat-form-field>
            <mat-label>{{ "filter" | translate }}</mat-label>
            <input
              matInput
              (keyup)="applyPublisherFilter($event)"
              placeholder="Ex. ium"
              #input
            />
          </mat-form-field>
        </div>
        <app-list-table
          class="pt-6"
          [dataSource]="PublisherData"
          [displayedColumns]="displayedPublisherColumns"
        >
        </app-list-table>
      </section>
    </mat-tab>

    <!-- Royalties -->
    <mat-tab>
      <ng-template mat-tab-label>
        <span class="text-text-heading font-medium">
          {{ "royalties&wallet" | translate }}
        </span>
      </ng-template>
      <section
        id="royalties"
        class="mt-10 bg-white p-6 rounded-xl shadow flex flex-col gap-6"
      >
        <h2 class="heading">{{ "Royalties&Wallet" | translate }}</h2>
        <ul class="space-y-2">
          <li>
            ü™ô {{ "walletbalance" | translate }} :
            <label class="font-medium">{{
              (authorDetails()?.user?.wallet?.totalAmount || 0) -
                (authorDetails()?.user?.wallet?.holdAmount || 0)
                | currency : "INR"
            }}</label>
          </li>
          <li>
            ‚è≥{{ "onhold" | translate }} :
            <label class="font-medium">{{
              authorDetails()?.user?.wallet?.holdAmount || 0 | currency : "INR"
            }}</label>
          </li>
        </ul>

        <app-list-table
          [dataSource]="royaltyData"
          [displayedColumns]="displayedRoyaltyColumns()"
        >
        </app-list-table>
      </section>
    </mat-tab>

    <!-- Published Links -->
    <mat-tab>
      <ng-template mat-tab-label>
        <span class="text-text-heading font-medium">
          {{ "publishedlinks" | translate }}
        </span>
      </ng-template>
      <section
        id="published-links"
        class="mt-10 bg-white p-6 rounded-xl shadow"
      >
        <h2 class="heading mb-4">Published Links</h2>
        <ul class="list-disc pl-6">
          @for (distribution of distributions(); track $index) {
          <li>
            <a target="_blank" [href]="distribution.link" class="text-blue-600">
              {{ distribution.type | translate }}
            </a>
          </li>
          }
        </ul>
      </section>
    </mat-tab>
    <!-- Attachments -->
    <!-- <mat-tab>
      <ng-template mat-tab-label>
        <span class="text-text-heading font-medium">
          {{ "attachments" | translate }}
        </span>
      </ng-template>
      <section id="attachments" class="mt-10 bg-white p-6 rounded-xl shadow">
        <h2 class="heading mb-4">Attachments</h2>
        <ul class="list-disc pl-6">
          <li><a href="#" class="text-blue-600">PAN Document</a></li>
          <li><a href="#" class="text-blue-600">Publisher Agreement</a></li>
        </ul>
      </section>
    </mat-tab> -->
  </mat-tab-group>
</div>
