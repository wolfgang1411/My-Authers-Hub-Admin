<div class="user-details flex flex-col h-full p-4 gap-4">
  <div class="flex justify-between items-center">
    <h2 class="text-xl heading !text-primary">
      {{ "userdetails" | translate }}
    </h2>
    <div class="flex gap-2">
      <button
        mat-stroked-button
        color="primary"
        class="!bg-primary !text-white"
        (click)="onExportUser()"
      >
        <mat-icon>download</mat-icon>
        {{ "export" | translate }}
      </button>
      <app-back></app-back>
    </div>
  </div>

  <div class="flex flex-col gap-4">
    <div
      class="flex justify-between items-center bg-primary text-white p-4 rounded-md shadow user-card"
    >
      <div class="flex flex-col gap-1">
        <h2 class="text-lg font-semibold">{{ displayName() }}</h2>
        <p class="text-sm">{{ user()?.email }}</p>
        <p class="text-sm">{{ user()?.phoneNumber || "—" }}</p>
      </div>
      <div class="flex items-center gap-2 flex-wrap justify-end">
        <span
          class="px-3 py-1 rounded-full text-xs font-semibold inline-block"
          [ngClass]="statusClass(user()?.status)"
        >
          {{ user()?.status || (user()?.active ? "ACTIVE" : "DEACTIVE") }}
        </span>
        <button
          class="!bg-primary"
          mat-icon-button
          (click)="changeStatus(getNextStatus(user()?.status))"
          [matTooltip]="
            getNextStatus(user()?.status) === 'ACTIVE'
              ? ('activatestatus' | translate)
              : ('deactivatestatus' | translate)
          "
        >
          <mat-icon class="!text-white">
            {{
              getNextStatus(user()?.status) === 'ACTIVE'
                ? 'toggle_on'
                : 'toggle_off'
            }}
          </mat-icon>
        </button>
      </div>
    </div>

    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
      <div class="bg-white shadow-md rounded-md p-4 user-card">
        <h3 class="text-md font-medium flex items-center gap-2">
          <mat-icon>badge</mat-icon>
          {{ "userinfo" | translate }}
        </h3>
        <div class="mt-3 text-sm space-y-2">
          <div class="flex justify-between gap-2">
            <span class="font-semibold">{{ "id" | translate }}</span>
            <span>#{{ user()?.id }}</span>
          </div>
          <div class="flex justify-between gap-2">
            <span class="font-semibold">{{ "accesslevel" | translate }}</span>
            <span>{{ user()?.accessLevel }}</span>
          </div>
          <div class="flex justify-between gap-2">
            <span class="font-semibold">{{ "createdat" | translate }}</span>
            <span>{{ user()?.created_date | date : "medium" }}</span>
          </div>
        </div>
      </div>

      <div class="bg-white shadow-md rounded-md p-4 user-card">
        <h3 class="text-md font-medium flex items-center gap-2">
          <mat-icon>account_balance_wallet</mat-icon>
          {{ "wallet" | translate }}
        </h3>
        <div class="mt-3 text-sm space-y-2">
          <div class="flex justify-between gap-2">
            <span class="font-semibold">{{ "totalamount" | translate }}</span>
            <span>{{ user()?.wallet?.totalAmount ?? "—" }}</span>
          </div>
          <div class="flex justify-between gap-2">
            <span class="font-semibold">{{ "holdamount" | translate }}</span>
            <span>{{ user()?.wallet?.holdAmount ?? "—" }}</span>
          </div>
          <div class="flex justify-between gap-2">
            <span class="font-semibold">{{ "lifetimeearnings" | translate }}</span>
            <span>{{ user()?.wallet?.lifeTimeEarnings ?? "—" }}</span>
          </div>
        </div>
      </div>
    </div>

    <div class="bg-white shadow-md rounded-md p-4 user-card">
      <h3 class="text-md font-medium flex items-center gap-2">
        <mat-icon>home</mat-icon>
        {{ "addresses" | translate }}
      </h3>
      <div class="mt-3 space-y-3">
        @if (user()?.address?.length) { @for (addr of user()?.address; track addr.id)
        {
        <div class="border p-3 rounded-md">
          <div class="text-sm font-semibold">{{ addr.address }}</div>
          <div class="text-sm text-[var(--text-secondary)]">
            {{ addr.city }}, {{ addr.state }}, {{ addr.country }} -
            {{ addr.pincode }}
          </div>
        </div>
        } } @else {
        <p class="text-sm text-[var(--text-secondary)]">
          {{ "noaddressesfound" | translate }}
        </p>
        }
      </div>
    </div>
  </div>
</div>

