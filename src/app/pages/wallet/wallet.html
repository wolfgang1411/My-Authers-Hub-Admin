<section class="bg-[var(--surface)] p-6 rounded-2xl text-[var(--text-primary)]">
  <!-- Header -->
  <div class="mb-10">
    <h1 class="text-3xl font-medium text-[var(--text-heading)]">
      Sales & Royalty Dashboard
    </h1>
    <p class="text-[var(--text-primary)] mt-1">
      Track book sales, monitor royalties, and manage withdrawals.
    </p>
  </div>

  <!-- Wallet Overview -->
  <div class="grid md:grid-cols-3 gap-6 mb-10">
    <!-- Withdrawals -->
    <div
      class="bg-gradient-to-br from-[var(--light-purple-bg)] to-white p-6 rounded-2xl shadow-md hover:shadow-xl border border-[var(--primary-superlight)] transition-all"
    >
      <div class="flex items-center gap-4 mb-4">
        <div
          class="bg-gradient-to-br from-[var(--green-2)] to-[var(--light-green-2)] text-white w-12 h-12 rounded-xl flex items-center justify-center text-xl font-bold"
        >
          â‚¹
        </div>
        <div>
          <h3 class="font-medium text-lg text-[var(--text-heading)]">
            Withdrawals
          </h3>
          <p class="text-sm text-[var(--text-primary)]">
            Total Paid or Requested
          </p>
        </div>
      </div>
      <div class="text-2xl font-medium text-[var(--text-heading)]">
        â‚¹{{ loggedInUser()?.wallet?.totalAmount ?? 0 }}
      </div>
      <p class="text-sm text-[var(--text-primary)] mt-1">
        Royalty Withdrawn :
        <span class="font-medium text-[var(--primary)]">
          {{
            (loggedInUser()?.wallet?.totalAmount ?? 0) -
              (loggedInUser()?.wallet?.holdAmount ?? 0) | currency : "INR"
          }}
        </span>
      </p>
    </div>

    <!-- Book Sales -->
    <div
      class="bg-gradient-to-br from-[var(--primary-superlight)] to-white p-6 rounded-2xl shadow-md hover:shadow-xl border border-[var(--primary-superlight)] transition-all"
    >
      <div class="flex items-center gap-4 mb-4">
        <div
          class="bg-gradient-to-br from-[var(--primary)] to-[var(--purple)] text-white w-12 h-12 rounded-xl flex items-center justify-center text-xl font-bold"
        >
          ðŸ“˜
        </div>
        <div>
          <h3 class="font-medium text-lg text-[var(--text-heading)]">
            Book Sales
          </h3>
          <p class="text-sm text-[var(--text-primary)]">Total Books Sold</p>
        </div>
      </div>
      <div class="text-2xl font-medium text-[var(--text-heading)]">
        {{ earningList().length }}
      </div>
      <p class="text-sm text-[var(--text-primary)] mt-1">
        Total Platforms :
        <span class="font-medium text-[var(--primary)]">
          {{ uniquePlatformsCount() }}
        </span>
      </p>
    </div>

    <!-- Earnings -->
    <div
      class="bg-gradient-to-br from-[var(--light-green-bg)] to-white p-6 rounded-2xl shadow-md hover:shadow-xl border border-[var(--primary-superlight)] transition-all"
    >
      <div class="flex items-center gap-4 mb-4">
        <div
          class="bg-gradient-to-br from-[var(--accent)] to-[var(--accent-light)] text-white w-12 h-12 rounded-xl flex items-center justify-center text-xl font-bold"
        >
          ðŸ’°
        </div>
        <div>
          <h3 class="font-medium text-lg text-[var(--text-heading)]">
            Earnings
          </h3>
          <p class="text-sm text-[var(--text-primary)]">Lifetime Earnings</p>
        </div>
      </div>
      <div class="text-2xl font-medium text-[var(--text-heading)]">
        {{ totalPaidFormatted() | currency : "INR" }}
      </div>
      <!-- <button
        class="mt-4 bg-[var(--green-2)] hover:bg-[var(--green-2)] text-white py-2 px-4 rounded-lg font-medium text-sm shadow-md active:bg-green-2/80"
      >
        Withdraw Funds
      </button> -->
    </div>
  </div>

  <!-- Recent Earnings & Wallet Summary -->
  <div class="grid md:grid-cols-3 gap-6 mt-10">
    <!-- Recent Earnings -->
    <div
      class="md:col-span-2 bg-white p-6 rounded-2xl shadow-md border border-[var(--primary-superlight)]"
    >
      <h3 class="text-lg font-medium text-[var(--text-heading)] mb-4">
        Recent Earnings
      </h3>
      <p class="text-[var(--text-primary)] mb-6 text-sm">
        Overview of your latest royalty transactions
      </p>

      @if (earningList().length) {
      <div class="flex flex-col gap-4">
        @for (e of earningList(); track e.id) {
        <div
          class="p-4 rounded-xl flex justify-between items-center border border-[var(--primary-superlight)] hover:bg-[var(--light-purple-bg)] transition-all shadow-sm"
        >
          <div>
            <div class="font-medium text-[var(--text-heading)]">
              {{ e.royalty.title.name || "Untitled" }}
            </div>
            <div class="text-sm text-[var(--text-primary)] mt-1">
              Platform:
              <span class="text-[var(--primary)] font-medium">
                {{ e.platform }}
              </span>
              â€¢
              <span
                class="capitalize"
                [class.text-[var(--green-2)]]="e.status === 'PAID'"
                [class.text-[var(--accent)]]="e.status === 'PENDING'"
              >
                {{ e.status }}
              </span>
            </div>
          </div>
          <div class="text-right">
            <div
              class="font-medium"
              [ngClass]="{
                'text-[var(--green-2)]': e.status === 'PAID',
                'text-[var(--text-primary)]': e.status !== 'PAID'
              }"
            >
              â‚¹{{ e.amount | number : "1.2-2" }}
            </div>
            <div class="text-xs text-[var(--text-primary)] mt-1">
              @if (e.holdUntil) { Hold until:
              <span class="text-[var(--primary)] font-medium">
                {{ e.holdUntil | date : "yyyy-MM-dd" }}
              </span>
              } @else {
              <span>Paid on:</span>
              <span class="text-[var(--primary)] font-medium">
                {{ e.paidAt | date : "yyyy-MM-dd" }}
              </span>
              }
            </div>
          </div>
        </div>
        }
      </div>
      } @else {
      <div
        class="text-center p-6 border border-[var(--primary-superlight)] rounded-xl text-[var(--text-primary)]"
      >
        No recent earnings available.
      </div>
      }
    </div>

    <!-- Wallet Summary -->
    <div
      class="bg-gradient-to-br from-[var(--light-purple-bg)] to-white p-6 rounded-2xl shadow-md border border-[var(--primary-superlight)] flex flex-col justify-between max-h-[260px]"
    >
      <div>
        <h3 class="text-lg font-medium text-[var(--text-heading)] mb-4">
          Wallet Summary
        </h3>

        <div class="space-y-3 text-sm">
          <div class="flex justify-between">
            <span class="text-[var(--text-primary)]">Total Amount</span>
            <span class="font-medium text-[var(--primary)]">
              â‚¹{{ loggedInUser()?.wallet?.totalAmount ?? 0 }}
            </span>
          </div>

          <div class="flex justify-between">
            <span class="text-[var(--text-primary)]">Hold Amount</span>
            <span class="font-medium text-[var(--accent)]">
              â‚¹{{ loggedInUser()?.wallet?.holdAmount ?? 0 }}
            </span>
          </div>

          <div class="flex justify-between">
            <span class="text-[var(--text-primary)]">Available Balance</span>
            <span class="font-medium text-[var(--green-2)]">
              â‚¹{{
                (loggedInUser()?.wallet?.totalAmount ?? 0) -
                  (loggedInUser()?.wallet?.holdAmount ?? 0)
              }}
            </span>
          </div>
        </div>
      </div>

      <div class="flex gap-3 mt-6">
        <button
          class="bg-[var(--green-2)] hover:bg-[var(--green-2)] text-white font-medium py-2 px-4 rounded-lg flex-1 shadow-md active:bg-green-2/80"
          (click)="onClickRequestPayout()"
        >
          Withdraw
        </button>
        <button
          class="border border-[var(--primary-superlight)] text-[var(--primary)] font-medium py-2 px-4 rounded-lg hover:bg-[var(--primary-superlight)] flex-1"
          [routerLink]="['/transactions']"
          routerLinkActive="router-link-active"
        >
          View Transactions
        </button>
      </div>
    </div>
  </div>
</section>
