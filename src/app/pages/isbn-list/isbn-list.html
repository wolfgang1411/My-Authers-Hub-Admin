<div class="flex flex-col flex-grow gap-4">
  <h3 class="heading">
    {{ "ISBN List" | translate }}
  </h3>

  <div class="flex justify-between w-full gap-4">
    <div
      class="flex h-[38px] items-center justify-center md:min-w-[480px] min-w-full gap-2"
    >
      <input
        class="input-field outline-none w-full"
        #input
        (input)="searchStr.next(input.value)"
        [placeholder]="'search' | translate"
      />
      <button
        class="btn h-[38px] flex items-center self-end justify-center gap-2"
        (click)="searchStr.next(input.value)"
      >
        <svg-icon
          src="images/magnifying-glass-solid-full.svg"
          class="w-4 fill-white flex"
        ></svg-icon>
        {{ "search" | translate }}
      </button>
    </div>
    <div class="flex gap-4 items-center">
      <button
        class="!bg-primary flex items-center gap-2 !text-white rounded-md p-2"
        matButton="filled"
        matButton
        (click)="createIsbn()"
      >
        <mat-icon class="material-icons">person_add</mat-icon>
        {{ "createisbn" | translate }}
      </button>
    </div>
  </div>

  <div class="flex justify-end mt-2">
    <mat-form-field>
      <mat-select
        [value]="filter.status"
        (valueChange)="filter.status = $event; fetchIsbnList()"
        placeholder="{{ 'status' | translate }}"
      >
        <mat-option [value]="0"> {{ "all" | translate }}</mat-option>
        @for (status of isbnStatuses(); track status) {
        <mat-option [value]="status">{{ status }}</mat-option>
        }
      </mat-select>
    </mat-form-field>
  </div>

  <app-list-table
    [dataSource]="dataSource"
    [displayedColumns]="displayedColumns"
    [actionTemplate]="actionButtons"
  >
  </app-list-table>
  <ng-template #actionButtons let-element>
    <div class="flex gap-2 text-sm items-center justify-end lg:flex-wrap">
      @if (element.image) {
      <button
        class="!bg-primary flex items-center gap-2 !text-white rounded-md p-2"
        matButton="filled"
        matButton
        (click)="downloadBarCode(element.isbnnumber)"
      >
        <mat-icon class="material-icons">download</mat-icon>

        {{ "barcode" | translate }}
      </button>
      } @if (element.bunko) {
      <button
        class="!bg-primary flex items-center gap-2 !text-white rounded-md p-2"
        matButton="filled"
        matButton
        (click)="downloadBunko(element)"
      >
        <mat-icon class="material-icons">download</mat-icon>

        {{ "bunko" | translate }}
      </button>
      } @if (element.status === 'PENDING') {
      <button
        class="!bg-primary flex items-center gap-2 !text-white rounded-full p-2"
        matIconButton
        (click)="createIsbn(element)"
      >
        <mat-icon class="material-icons">edit</mat-icon>
      </button>
      } @if (element.isbnNumber && element.status === 'PENDING' &&
      loggedInUser$()?.accessLevel === 'SUPERADMIN') {
      <button
        class="!bg-green-600 flex items-center gap-2 !text-white rounded-full p-2"
        matIconButton
        (click)="onISBNStatusChange(element.id, 'APPROVED')"
      >
        <mat-icon class="material-icons">thumb_up</mat-icon>
      </button>
      <button
        class="!bg-red-500 flex items-center gap-2 !text-white rounded-full p-2"
        matIconButton
        (click)="onISBNStatusChange(element.id, 'REJECTED')"
      >
        <mat-icon class="material-icons">thumb_down</mat-icon>
      </button>
      }
    </div>
  </ng-template>
</div>
