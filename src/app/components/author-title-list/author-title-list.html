<div
  class="p-6 border border-[var(--primary-superlight)] bg-white rounded-xl shadow-md"
>
  <h4
    class="text-lg font-medium text-[var(--primary)] mb-4 flex items-center capitalize"
  >
    <mat-icon class="mr-2 text-[var(--primary)]">library_books</mat-icon>
    Titles by {{ author()?.user?.firstName }} {{ author()?.user?.lastName }}
  </h4>

  @if (loading()) {
    <div class="text-sm text-[var(--text-secondary)]">Loading...</div>
  }
  @if (!loading() && !titles().length) {
    <div class="text-sm text-[var(--text-secondary)]">No titles found.</div>
  }
  @if (titles().length) {
    <!-- DESKTOP TABLE -->
    <div class="hidden md:block">
      <table class="w-full !rounded-2xl overflow-hidden shadow-sm">
        <thead class="bg-[var(--primary-superlight)]">
          <tr>
            <th class="px-5 py-3 text-left text-sm font-medium">Title</th>
            <th class="px-5 py-3 text-left text-sm font-medium">
              Published By
            </th>
            <th class="px-5 py-3 text-left text-sm font-medium">Books Sold</th>
            <th class="px-5 py-3 text-left text-sm font-medium">
              Author Copies Price
            </th>
            <th class="px-5 py-3 text-left text-sm font-medium">ISBN</th>
            <th class="px-5 py-3 text-left text-sm font-medium">Status</th>
            <th class="px-5 py-3 text-left text-sm font-medium">View</th>
          </tr>
        </thead>

        <tbody class="divide-y divide-[var(--primary-superlight)]">
          @for (t of titles(); track t.id) {
            <tr class="hover:bg-[var(--light-purple-bg)]">
              <td class="px-5 py-3 font-medium text-[var(--primary)]">
                {{ t.name }}
              </td>
              <td class="px-5 py-3 capitalize">{{ t.publisherDisplay }}</td>
              <td class="px-5 py-3">{{ t.copiesSold }}</td>
              <td class="px-5 py-3">
                @if (
                  t.authors?.[0]?.allowAuthorCopy &&
                  (t.printing?.[0]?.customPrintCost ||
                    t.printing?.[0]?.printCost)
                ) {
                  ₹{{
                    t.printing?.[0]?.customPrintCost ||
                      t.printing?.[0]?.printCost | number: "1.2-2"
                  }}
                } @else {
                  N/A
                }
              </td>
              <td class="px-5 py-3">
                <div>{{ t.isbnPrint ? (t.isbnPrint | isbnFormat) : "—" }}</div>
                <div>{{ t.isbnEbook || "" }}</div>
              </td>
              <td class="px-5 py-3 capitalize">{{ t.status }}</td>
              <td class="px-5 py-3">
                <button
                  mat-icon-button
                  class="!bg-primary"
                  [routerLink]="['/titleSummary', t.id]"
                >
                  <mat-icon class="!text-white">visibility</mat-icon>
                </button>
              </td>
            </tr>
          }
        </tbody>
      </table>
    </div>

    <!-- MOBILE CARD VIEW -->
    <div class="md:hidden space-y-4">
      @for (t of titles(); track t.id) {
        <div
          class="border border-[var(--primary-superlight)] rounded-xl p-4 bg-white shadow-sm"
        >
          <div class="flex justify-between items-start gap-3">
            <h5 class="font-semibold text-[var(--primary)]">
              {{ t.name }}
            </h5>

            <button
              mat-icon-button
              class="!bg-primary"
              [routerLink]="['/titleSummary', t.id]"
            >
              <mat-icon class="!text-white">visibility</mat-icon>
            </button>
          </div>

          <div class="mt-3 space-y-1 text-sm">
            <p>
              <span class="font-medium">Publisher:</span>
              {{ t.publisherDisplay }}
            </p>
            <p>
              <span class="font-medium">Books Sold:</span> {{ t.copiesSold }}
            </p>

            <p>
              <span class="font-medium">Author Copy Price:</span>
              @if (
                t.authors?.[0]?.allowAuthorCopy &&
                (t.printing?.[0]?.customPrintCost || t.printing?.[0]?.printCost)
              ) {
                ₹{{
                  t.printing?.[0]?.customPrintCost || t.printing?.[0]?.printCost
                    | number: "1.2-2"
                }}
              } @else {
                N/A
              }
            </p>

            <p>
              <span class="font-medium">ISBN:</span>
              {{ t.isbnPrint ? (t.isbnPrint | isbnFormat) : "—" }}
              {{ t.isbnEbook ? " / " + t.isbnEbook : "" }}
            </p>

            <p>
              <span class="font-medium">Status:</span>
              <span class="capitalize">{{ t.status }}</span>
            </p>
          </div>
        </div>
      }
    </div>
  }
</div>
